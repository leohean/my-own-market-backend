create table PHOTOS(
	ID_PHOTO INTEGER generated always as IDENTITY primary key,
	PHOTO_FILE BYTEA,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE
);

CREATE TABLE CLIENT(
	ID_CLIENT INTEGER generated always as IDENTITY primary key,
	NAME TEXT NOT NULL,
	EMAIL TEXT NOT NULL,
	PASSWORD text not null,
	BIRTH DATE NOT null,
	CPF text not null,
	ID_PHOTO INTEGER,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE,
	CONSTRAINT FK_ID_PHOTO_OF_CLIENT
		foreign KEY(ID_PHOTO) 
			references PHOTOS (ID_PHOTO)
);

CREATE TABLE MARKET(
	ID_MARKET INTEGER generated always as IDENTITY primary key,
	NAME TEXT NOT NULL,
	EMAIL TEXT NOT NULL,
	PASSWORD text not null,
	CNPJ text not null,
	ID_PHOTO INTEGER,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE,
	CONSTRAINT FK_ID_PHOTO_OF_MARKET
		foreign KEY(ID_PHOTO) 
			references PHOTOS (ID_PHOTO)
);

CREATE TABLE PRODUCT(
	ID_PRODUCT INTEGER generated always as IDENTITY primary key,
	NAME TEXT NOT NULL,
	CATEGORY TEXT NOT NULL,
	DESCRIPTION text not null,
	UNIT_MEASURENT text not null,
	STOCK_QUANTITY REAL,
	ID_PHOTO INTEGER,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE,
	
	CONSTRAINT FK_ID_PHOTO_OF_PRODUCT
		foreign KEY(ID_PHOTO) 
			references PHOTOS (ID_PHOTO)
);

CREATE TABLE PURCHASE(
	ID_PURCHASE INTEGER generated always as IDENTITY primary key,
	ID_CLIENT INTEGER not NULL,
	ID_MARKET INTEGER not NULL,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE,
	
	CONSTRAINT FK_ID_CLIENT_OF_PURCHASE
		foreign KEY(ID_CLIENT) 
			references CLIENT (ID_CLIENT),
			
	CONSTRAINT FK_ID_MARKET_OF_PURCHASE
		foreign KEY(ID_MARKET) 
			references MARKET (ID_MARKET)
);

CREATE TABLE PURCHASE_LINES(
	ID_PURCHASE_LINE INTEGER generated always as IDENTITY primary key,
	ID_PURCHASE INTEGER not NULL,
	ID_PRODUCT INTEGER not NULL,
	QUANTITY_LINE real,
	CREATION_DATE DATE,
	LAST_UPDATE_DATE DATE,
	
	CONSTRAINT FK_ID_PURCHASE_OF_PURCHASE_LINES
		foreign KEY(ID_PURCHASE) 
			references PURCHASE (ID_PURCHASE),
			
	CONSTRAINT FK_ID_PRODUCT_OF_PURCHASE_LINES
		foreign KEY(ID_PRODUCT) 
			references PRODUCT (ID_PRODUCT)
);






